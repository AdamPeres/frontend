@import '../_vars';
@import '../_mixins';

//specific vars for colours for dynamo
$story-package-container-colour: #e0e4e8;
$story-package-card-colour: #041f4a;
$container-title: $story-package-card-colour;
$story-package-dynamic-card-text: $story-package-card-colour;

@mixin pillar-override($tone, $colour, $dark-colour) {
    .fc-item--pillar-#{$tone} {
        .fc-item__kicker,
        .rich-link__kicker,
        .fc-item__byline {
            color: $colour;
        }

        &.fc-item--dynamic-layout {
            .fc-item__kicker,
            .rich-link__kicker,
            .fc-item__byline {
                color: $dark-colour;
            }

            .inline-garnett-quote {
                fill: $dark-colour;
            }
        }

        .fc-item__container:before {
            background-color: #ffffff;
        }

        &.fc-item.fc-item--full-media-100-tablet .fc-item__title {
            background-image: none;
        }
    }

    .fc-item:not(.fc-item--pillar-special-report) {
        .fc-sublink--pillar-#{$tone} {
            .fc-sublink__kicker {
                color: $colour;
            }
        }

        &.fc-item--dynamic-layout:not(.fc-item--pillar-special-report) {
            .fc-sublink--pillar-#{$tone} {
                .fc-sublink__kicker {
                    color: $dark-colour;
                }
            }
        }
    }
}

.fc-container--story-package {
    background-color: $story-package-container-colour;

    .fc-container__body {
        position: relative;
        @include mq($from: leftCol) {
            &:before {
                position: absolute;
                content: '';
                display: block;
                top: 0;
                bottom: -12px;
                width: 1px;
                background-color: #929698;
                left: -10px;
            }
        }
    }

    &.fc-container--first {
        .fc-container__body:before {
            top: -6px;
        }

        .fc-container__inner {
            border-top: 0;
        }
    }

    .fc-slice__item + .fc-slice__item:before {
        border-left-color: #929698; // This colour does not exist (in the palette)
    }

    .fc-container__toggle {
        display: none;
    }

    .fc-container__header__title {
        padding-left: calc((#{$gs-baseline} / 2) - 2px);
        margin-bottom: $gs-baseline / 2;

        &:after {
            display: none;
        }

        @include mq($from: desktop) {
            padding-left: 0px;
        }

        & > span,
        h2.fc-container__title__text {
            color: $container-title;
            display: inline-block;
            line-height: 24px;
            top: 6px;
            position: relative;
            padding-right: 4px;

            @include mq($from: tablet) {
                top: 0px;
            }
        }

        a:hover {
            text-decoration: none;
            border-bottom: #ffffff;
        }
    }

    .fc-container__header__description {
        color: $story-package-dynamic-card-text;
    }

    .fc-container__inner {
        border-top: 1px solid #929698;

        @include mq($from: tablet) {
            overflow: visible;
        }
    }

    .fc-item--pillar-news.fc-item--type-analysis.fc-item--full-media-75-tablet .fc-item__title {
        background-image: none;
    }

    .fc-item {
        .youtube-media-atom__play-button {
            bottom: 43%;
        }
    }

    //These need to be this specific as elsewhere in pillars.scss these are targeted using 3 selectors
    .fc-item,
    .fc-item.fc-item--pillar-opinion,
    .fc-item.fc-item--pillar-news.fc-item--type-comment,
    .fc-item.fc-item--pillar-opinion.fc-item--type-comment,
    .fc-item.fc-item--pillar-sport.fc-item--type-comment,
    .fc-item.fc-item--pillar-lifestyle.fc-item--type-comment,
    .fc-item.fc-item--pillar-arts.fc-item--type-comment,
    .fc-item.fc-item--type-feature {
        &:not(.fc-item--dynamic-layout) {
            background-color: $story-package-card-colour;

            .fc-item__headline {
                color: #ffffff;
            }
        }

        background-color: $story-package-card-colour; // This colour does not exist (in the palette)

        &:hover {
            background-color: darken($story-package-card-colour, 5%);

            .fc-trail__count--commentcount {
                background-color: darken($story-package-card-colour, 5%);
            }
        }

        .fc-trail__count--commentcount {
            background-color: $story-package-card-colour;
        }
    }

    // I'm not sure this is at all reliable, or a good idea, but until I figure
    // out what classes I want to add in Scala this gets things moving:
    .l-row__item--span-3 + .l-row__item--span-1 {
        .fc-item--live-updates {
            &.fc-item--standard-tablet {
                .fc-item__media-wrapper {
                    display: block;
                }
            }
        }
    }

    .fc-item--live-updates {
        $border-bottom-width: 5px;
        $circle-diameter: 13px;
        $circle-top-position: 5px;
        $thin-border: 1px;

        @include mq($from: desktop) {
            &.fc-item--standard-tablet {
                .fc-item__media-wrapper {
                    display: none;
                }
            }

            .fc-item__liveblog-blocks {
                height: 100%;
            }
        }

        .fc-item__liveblog-block__text {
            background-color: transparent;
            border-top: 0;
            border-bottom: $border-bottom-width solid $story-package-card-colour;
            font-family: 'Guardian Text Sans Web', 'Helvetica Neue', Helvetica, Arial, 'Lucida Grande', sans-serif;
            padding-left: 20px;
            position: relative;
        }

        .fc-item__liveblog-block__text:after {
            color: mix(#ffffff, $story-package-card-colour, 92%);
            background-color: $story-package-card-colour;
            box-shadow: -5px 0 5px -2px $story-package-card-colour;
        }

        &:hover {
            .fc-item__liveblog-block__text:after {
                color: mix(#ffffff, $story-package-card-colour, 92%);
                background-color: darken($story-package-card-colour, 5%);
                box-shadow: -5px 0 5px -2px darken($story-package-card-colour, 5%);
            }

            .fc-item__liveblog-block__text {
                border-bottom: $border-bottom-width solid darken($story-package-card-colour, 5%);
            }
        }

        .fc-item__liveblog-blocks--visible {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.1 linear;
        }

        .fc-item__liveblog-blocks--hidden {
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s 0.1s, opacity 0.1s linear;
        }

        .fc-item__liveblog-blocks__inner {
            transition: none;
            transform: none;
        }

        // Live update circle
        .fc-item__liveblog-block__time:before {
            content: '';
            color: #ffffff;
            border: $thin-border solid #ffffff;
            border-radius: 50%;
            height: $circle-diameter;
            width: $circle-diameter;
            display: block;
            position: absolute;
            left: 0;
            top: $circle-top-position;
        }

        // Live update circle connector/line
        .fc-item__liveblog-block:first-of-type:not(:only-child) {
            &:before {
                content: '';
                color: #ffffff;
                border: 0;
                border-left: 1px solid #ffffff;
                border-radius: 0;
                height: calc(100% - #{$circle-diameter} - #{$thin-border * 2});
                width: $thin-border;
                display: block;
                position: absolute;
                left: calc((#{$circle-diameter} / 2) + #{$thin-border});
                top: calc(#{$circle-top-position} + #{$circle-diameter} + #{$thin-border * 2});
                z-index: 2;
            }
        }
    }

    // Comment style overrides
    .fc-item--pillar-news.fc-item--type-comment,
    .fc-item--pillar-opinion.fc-item--type-comment,
    .fc-item--pillar-sport.fc-item--type-comment,
    .fc-item--pillar-arts.fc-item--type-comment,
    .fc-item--pillar-lifestyle.fc-item--type-comment {
        .fc-item__meta {
            background-image: none;
        }

        .fc-item__standfirst-wrapper .fc-item__meta {
            background-image: none;
        }

        .fc-item__container.u-faux-block-link--hover {
            background-color: darken($story-package-card-colour, 5%);
        }
    }

    .fc-item__container.u-faux-block-link--hover {
        background-color: darken($story-package-card-colour, 5%);
    }

    .fc-item__standfirst {
        color: #ffffff;
    }

    .fc-sublink__title {
        color: #ffffff;
    }

    &.fc-item--dynamic-layout {
        .fc-item__standfirst {
            color: $story-package-dynamic-card-text;
        }

        .fc-sublink__title {
            color: $story-package-dynamic-card-text;
        }
    }

    .treats__list-item {
        .treats__treat {
            background-color: $brightness-86;
            border-color: $story-package-card-colour;
            color: $story-package-card-colour;
        }
    }

    .fc-container__header__title > h2 {
        color: $story-package-dynamic-card-text;
    }

    // 'Dynamic Layout'
    .fc-item__content--above {
        display: none;
    }

    .fc-item--dynamic-layout {
        background-color: $story-package-container-colour;

        &.fc-item--type-feature {
            background-color: $story-package-container-colour;
        }

        // The white line above the story
        .fc-item__container:before {
            display: none; // Remove existing on container
        }

        .fc-item__container.u-faux-block-link--hover {
            background-color: darken($story-package-container-colour, 5%);
        }

        .fc-item__content:before {
            content: '';
            background-color: $story-package-dynamic-card-text;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: 2;
            height: $gs-baseline / 3;
            width: calc(100% - 10px);
        }

        .fc-item__content {
            padding-top: $gs-baseline / 2;
        }

        .fc-item--has-boosted-title {
            .fc-item__content--below .fc-item__header {
                display: none;
            }

            .fc-item__content--above {
                display: block;
                padding-top: $gs-baseline;
            }
        }

        &:hover {
            background-color: darken($story-package-container-colour, 5%);

            .fc-trail__count--commentcount {
                background-color: darken($story-package-container-colour, 5%);
            }
        }

        .fc-trail__count--commentcount {
            background-color: $story-package-container-colour;
        }

        @include mq($until: tablet) {
            .fc-item__content--below .fc-item__header {
                display: none;
            }

            .fc-item__content--above {
                display: block;
            }
        }

        .fc-item__kicker:after {
            display: none;
        }

        .fc-item__headline,
        .fc-item__standfirst,
        .fc-sublink__title {
            color: $story-package-dynamic-card-text;
        }
    }

    //These need to exist for all kickers because of tone on tone action
    @include pillar-override(lifestyle, $lifestyle-bright, $lifestyle-dark);
    @include pillar-override(arts, $culture-bright, $culture-dark);
    @include pillar-override(sport, $sport-bright, $sport-dark);
    @include pillar-override(opinion, $opinion-pastel, $opinion-dark);
    @include pillar-override(news, $lifestyle-pastel, $news-dark);
    @include pillar-override(special-report, $highlight-main, $highlight-dark);
}
